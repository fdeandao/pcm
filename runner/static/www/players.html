<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script  src="/js/libs/jquery-1.9.0/jquery.min.js"></script>
        <script  src="/js/pcm.utils.js"></script>
        <script>
            /**
             * Comment
             */
            function loadPlayers() {
                var nation = $("#p_nationallity").val();
                var club = $("#p_club").val();
                var name = $("#p_name").val();
                var start = $("#p_start").val();
                var count = $("#p_count").val();
                $.get("/api/players/" + nation + "/" + club + "/" + name + "/" + start + "/" + count, function(data) {
                    $("#thplayers").empty();
                    $("#tbplayers").empty();
                    $("#r_resp").val("");
                    if (data.PLAYERSCSV) {
                        if (data.PLAYERSCSV.length > 0) {
                            for (var colname in data.PLAYERSCSV[0]) {
                                $("#thplayers").append("<th>" + colname + "</th>");
                            }

                            for (var i = 0; i < data.PLAYERSCSV.length; i++) {
                                var player = data.PLAYERSCSV[i];
                                var row = $("<tr>");
                                for (var dat in player) {
                                    row.append("<td>" + player[dat] + "</td>");
                                }
                                $("#tbplayers").append(row);
                            }
                        }
                    }
                    if (data.COUNT) {
                        $("#r_resp").val("Results: " + data.COUNT);
                    }
                    if (data.error) {
                        $("#r_resp").val(data.error);
                    }
                })
                        .fail(function() {
                    alert("error");
                });
            }

            $(document).ready(function() {
                $("#header").load("menu.html");
                $("#footer").load("footer.html");
                getClubs($("#p_club"), function() {
                    getCountries($("#p_nationallity"), function() {
                        loadPlayers();
                    });
                });
                $("#p_search").click(function() {
                    loadPlayers();
                });
                $("#p_back").click(function() {
                    var sta = parseInt($("#p_start").val());
                    var cou = parseInt($("#p_count").val());
                    sta = (sta - cou < 0) ? 0 : sta - cou;
                    $("#p_start").val(sta);
                    loadPlayers();
                });
                $("#p_next").click(function() {
                    var sta = parseInt($("#p_start").val());
                    var cou = parseInt($("#p_count").val());
                    sta += cou;
                    $("#p_start").val(sta);
                    loadPlayers();
                });
                $("#p_nationallity").change(function(){
                    $("#p_start").val("1");
                });
                $("#p_club").change(function(){
                    $("#p_start").val("1");
                });
                $("#p_name").change(function(){
                    $("#p_start").val("1");
                });
            });
        </script>
    </head>
    <body>
        <div id="header"></div>
        <div id="content">
            <div id="param_search">
                <label for="p_nationallity">Nationality</label>
                <select id="p_nationallity"></select>
                <label for="p_club">Club</label>
                <select id="p_club"></select>
                <label for="p_name">Name</label>
                <input id="p_name" type="text" value="all"/>
                <label for="p_start">Start</label>
                <input id="p_start" type="text" value="1"/>
                <label for="p_count">Count</label>
                <input id="p_count" type="text" value="10"/>
                <input id="p_search" type="button" value="Search"/>
                <input id="p_back" type="button" value="Back"/>
                <input id="p_next" type="button" value="Next"/>
                <span id="r_resp"></span>
            </div>
            <table>
                <thead id="thplayers">
                </thead>
                <tbody id="tbplayers">

                </tbody>
            </table>
        </div>
        <div id="footer"></div>
    </body>
</html>
